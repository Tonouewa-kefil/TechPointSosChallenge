#:import ZBarCam kivy_garden.zbarcam.ZBarCam
#:import ZBarSymbol pyzbar.pyzbar.ZBarSymbol

TransitionAppManagement:
    HomeScreen:
    CreateAccountScreen:
    MainScreen:
    ProfileScreen:
    TransportationHistoryScreen:
    ItemDescriptionScreen:
    ScannerScreen:
    SymptomsScreen:
    SymptomsHistoryScreen
<HomeScreen>:
    name:"Home"
    email: email
    password: password
    sign_in:  sign_in
    create_account: create_account
    authentification_status: authentification_status

    FloatLayout:
        TextInput:
            id: email
            font_size: root.height * 0.025
            size_hint: 0.504,0.05
            pos_hint:{"top":0.72,"x":0.255}
            text:"Email"
            multiline: False
        TextInput:
            id: password
            font_size: root.height * 0.025
            size_hint: 0.504,0.05
            pos_hint:{"top":0.63,"x":0.255}
            text:"Password"
            multiline: False
        Label:
            id: authentification_status
            font_size: root.height * 0.015
            color:(1,0,0,1)
            size_hint: 0.504,0.05
            pos_hint:{"top":0.50,"x":0.255}
            halign: 'center'
            valign: 'middle'
            text:""
            font_size: 13
            multiline: False
        Button:
            id: sign_in
            font_size: 13
            size_hint:0.31,0.035
            pos_hint:{"top":0.53,"x":0.345}
            text:"Sign in"
            background_color:(0,0,0,1)
            on_release:
                if root.signing_in() == True:\
                app.root.current = "Main"
                root.manager.transition.direction = 'up'
        Button:
            id: create_account
            font_size: root.height * 0.025
            size_hint: 0.54,0.05
            pos_hint:{"top":0.26,"x":0.255}
            text:"Create Account"
            background_color:(0,0,0,1)
            on_release:
                app.root.current = "Create"
                root.manager.transition.direction = 'left'

<CreateAccountScreen>:
    name:"Create"
    go_back: go_back
    email: email
    password: password
    confirmation: confirmation
    create: create
    isFieldBlanked: isFieldBlanked


    FloatLayout:
        # Back button
        ImageButton:
            id:go_back
            pos_hint:{"top":0.97,"x":0.0613}
            size_hint: 0.035,0.033
            source: "Media/PngItem_2022960.png"
            on_release:
                app.root.current = "Home"
                root.manager.transition.direction = 'right'
        Label:
            text:"Welcome!"
            font_size: 30
            size_hint: 0.35,0.18
            pos_hint:{"top":0.88,"x":0.32}
            halign: 'center'
            valign: 'middle'
            color: (0,0,0,1)
        Label:
            text:"Thanks for helping to \n keep transportation in our city safe"
            font_size: 15
            size_hint: 0.66,0.054
            pos_hint:{"top":0.76,"x":0.171}
            halign: 'center'
            valign: 'middle'
            color: (0,0,0,1)
        Label:
            text:"Let's get your Account set up..."
            font_size: 17
            size_hint: 0.61,0.04
            pos_hint:{"top":0.53,"x":0.193}
            color: (0,0,0,1)
        TextInput:
            id: email
            font_size: root.height * 0.025
            size_hint:0.504,0.05
            pos_hint:{"top":0.38,"x":0.22}
            text:"Email"
            multiline: False
        TextInput:
            id: password
            font_size: root.height * 0.025
            size_hint: 0.504, 0.05
            pos_hint:{"top":0.31,"x":0.22}
            text:"Password"
            multiline: False
        TextInput:
            id: confirmation
            font_size: root.height * 0.025
            size_hint:0.504,0.05
            pos_hint:{"top":0.24,"x":0.22}
            text:"Confirm Password"
            multiline: False
        Button:
            id: create
            font_size: 17
            size_hint:0.355,0.05
            pos_hint:{"top":0.15,"x":0.295}
            text:"Create!"
            background_color:(0,0,0,1)
            on_release:
                if root.NewAccountCreation() == True:\
                app.root.current = "Home"
                root.manager.transition.direction = 'right'
        Label:
            id: isFieldBlanked
            font_size: root.height * 0.015
            color:(1,0,0,1)
            size_hint: 0.504,0.05
            pos_hint:{"top":0.10,"x":0.23}
            halign: 'center'
            valign: 'middle'
            text:""
            font_size: 13
            multiline: False


<MainScreen>:
    name:"Main"
    FloatLayout:
    # Profile Image / Button
        ImageButton:
            pos_hint: { "top":0.8996, "x":0.2853 }
            size_hint: 0.4267, 0.24
            source: "Media/pfp_peach.png"
            on_release:
                app.root.current = "Profile"
                root.manager.transition.direction = 'left'

        Label:
            pos_hint:{"top":0.92,"x":0.387}
            size_hint:0.2053,0.0345
            text:"Profile"
            halign: 'center'
            valign: 'middle'
            font_size:20
            color:0,0,0,1

        # Lost and Found Image / Button
        ImageButton:
            pos_hint: { "top":0.585, "x":0.0853 }
            size_hint: 0.231, 0.13
            source: "Media/icon_lnf.png"
            on_release:
                app.root.current = "History"
                root.manager.transition.direction = 'left'
        # Lost and Found/ Label
        Label:
            pos_hint: { "top":0.4543, "x":0.0987 }
            size_hint:0.2053,0.0345
            text:"Lost & Found"
            color:0,0,0,1

        # Symptoms Image / Button
        ImageButton:
            pos_hint: { "top":0.585, "x":0.71 }
            size_hint: 0.231, 0.13
            source: "Media/icon_symptoms.png"
            on_release:
                app.root.current = "Symptoms"
                root.manager.transition.direction = 'left'
        Label:
            pos_hint:{"top":0.453,"x":0.723 }
            size_hint:0.2053,0.0345
            text:"Symptoms Quiz"
            color:0,0,0,1

        # Scanner Image / Button
        ImageButton:
            pos_hint: {"top":0.222,"x":0.387}
            size_hint: 0.231, 0.13
            source: "Media/icon_scanner.png"
            on_release:
                app.root.current = "Scan"
                root.manager.transition.direction = 'left'
        Label:
            pos_hint:{"top":0.092 ,"x":0.387}
            size_hint:0.2053,0.0345
            text:"QR Scan"
            color:0,0,0,1

<ProfileScreen>:
    name: "Profile"
    greetings: greetings
    userPhoneNumber: userPhoneNumber
    userEmail: userEmail

    FloatLayout:
        # Back button
        ImageButton:
            pos_hint:{"top":0.97,"x":0.0613}
            size_hint: 0.035,0.033
            source: "Media/PngItem_2022960.png"
            on_release:
                app.root.current = "Main"
                root.manager.transition.direction = 'right'
        # Profile Image
        Image:
            pos_hint: {"top":0.90, "x":0.29 }
            size_hint: 0.427, 0.24
            source: "Media/pfp_peach.png"
        # "Hello, [name]"
        Label:
            id: greetings
            text: "Hello, there!"
            font_size: 25
            pos_hint: {"top":0.66, "x":0.18 }
            size_hint:0.63,0.036
            halign: 'center'
            valign: 'middle'
            color: 0,0,0,1
        Label:
            text: "Phone:"
            font_size: 18
            pos_hint: {"top":0.555, "x":0.123 }
            size_hint:0.1627,0.036
            halign: 'center'
            valign: 'middle'
            color: 0,0,0,1
        # Input for phone number
        TextInput:
            id:userPhoneNumber
            font_size: 16
            pos_hint: { "top":0.56, "x":0.30 }
            size_hint:0.536,0.050
            text:"Enter a phone number"
            #on_focus: self.text = ""
            multiline: False
            input_type: 'tel'
            write_tab: False
            #on_text_validate: root.foo()
        # "Email"
        Label:
            text: "Email:"
            font_size: 18
            pos_hint: {"top":0.465, "x":0.123 }
            size_hint:0.1627,0.036
            halign: 'center'
            valign: 'middle'
            color:0,0,0,1
        # Input for email
        TextInput:
            id:userEmail
            font_size: 16
            pos_hint: { "top":0.471, "x":0.30 }
            size_hint:0.536,0.050
            text:"Enter an email"
            #on_focus: self.text = ""
            multiline: False
            input_type: 'mail'
            #on_text_validate: root.foo()
        # Transportation History Button
        Button:
            size_hint: ( 0.723, 0.05 )
            pos_hint: { "top":0.294, "x":0.123 }
            text: "Transportation History"
            font_size: 18
            color: 0,0,0,1
            background_normal: 'Media/asset.button_normal.png'
            on_release:
                app.root.current = "History"
                root.manager.transition.direction = 'left'
        # Symptom History Button
        Button:
            size_hint: ( 0.723, 0.05 )
            pos_hint: { "top":0.21, "x":0.123 }
            text: "Symptom History"
            font_size: 18
            color: 0,0,0,1
            background_normal: 'Media/asset.button_normal.png'
            on_release:
                app.root.current = "symptomsHistory"
                root.manager.transition.direction = 'left'
        # Sign out Button, leads to the login page
        Button:
            size_hint: ( 0.4, 0.04 )
            pos_hint: { "center_x":0.5, "center_y":0.1 }
            text: "Sign Out"
            font_size: 14
            color: 0,0,0,1
            background_normal: 'Media/asset.button_warning.png'
            on_release:
                app.root.current = "Home"
                root.manager.transition.direction = 'down'

<TransportationHistoryScreen>:
    name:"History"
    FloatLayout:
        # Back button
        ImageButton:
            pos_hint:{"top":0.97,"x":0.0613}
            size_hint: 0.035,0.033
            source: "Media/PngItem_2022960.png"
            on_release:
                app.root.current = "Main"
                root.manager.transition.direction = 'right'
        Label:
            text:"Recently Used Transportation"
            font_size: 25
            size_hint:0.88,0.045
            pos_hint:{"top":0.89,"x":0.06}
            color: (0,0,0,1)
        Button:
            font_size: 15
            size_hint:0.69,0.11
            pos_hint:{"top":0.77,"x":0.16}
            text:""
            background_normal:''
            background_color:(1,1,1,1)
            on_release:
                app.root.current = "LostItem"
                root.manager.transition.direction = 'left'
        Button:
            font_size: 15
            size_hint:0.69,0.11
            pos_hint:{"top":0.573,"x":0.16}
            text:""
            background_normal:''
            background_color:(1,1,1,1)
            on_release:
                app.root.current = "LostItem"
                root.manager.transition.direction = 'left'
        Button:
            font_size: 15
            size_hint:0.69,0.11
            pos_hint:{"top":0.384,"x":0.16}
            text:""
            background_normal:''
            background_color:(1,1,1,1)
            on_release:
                app.root.current = "LostItem"
                root.manager.transition.direction = 'left'
        Button:
            text:"See more ..."
            size_hint:0.35,0.0435
            pos_hint:{"top":0.21,"x":0.33}
            background_color: (0,0,0,1)
        Label:
            text:"If you lost an Item, select the \n transportation to fill a claim"
            size_hint:0.483,0.051
            pos_hint:{"top":0.12,"x":0.26}
            font_size: 14
            color: (0,0,0,1)
<ItemDescriptionScreen>:
    name:"LostItem"
    smsText: smsText
    phoneCall: phoneCall
    email: email
    FloatLayout:
        # Back button
        ImageButton:
            pos_hint:{"top":0.97,"x":0.0613}
            size_hint: 0.035,0.033
            source: "Media/PngItem_2022960.png"
            on_release:
                app.root.current = "History"
                root.manager.transition.direction = 'right'
        Label:
            text:"Describe your Lost Item"
            font_size: 25
            size_hint:0.70,0.045
            pos_hint:{"top":0.89,"x":0.15}
        TextInput:
            text:""
            font_size: 15
            size_hint:0.88,0.31
            pos_hint:{"top":0.81,"x":0.0613}
            multiline: True
        Label:
            text:"Best way to contact you?"
            size_hint:0.59,0.081
            pos_hint:{"top":0.4423,"x":0.0613}
            font_size: 20
        Button:
            id: smsText
            text:"SMS Text"
            size_hint:0.40,0.048
            pos_hint:{"top":0.36,"x":0.0613}
            font_size: 20
            background_color:(0,0,0,1)
        Button:
            id: phoneCall
            text:"Phone Call"
            size_hint:0.40,0.048
            pos_hint:{"top":0.26,"x":0.0613}
            font_call: 20
            background_color:(0,0,0,1)
        Button:
            id: email
            text:"Email"
            size_hint:0.40,0.048
            pos_hint:{"top":0.16,"x":0.0613}
            font_call: 20
            background_color:(0,0,0,1)
        Button:
            text:"Submit"
            size_hint:0.40,0.048
            pos_hint:{"top":0.084,"x":0.3013}
            font_call: 17
            background_color:(0,1,0,1)
            on_release:
                app.root.current = "Profile"
                root.manager.transition.direction = 'right'


<ScannerScreen>:
    name:"Scan"
    FloatLayout:
        ImageButton:
            pos_hint:{"top":0.97,"x":0.0613}
            size_hint: 0.035,0.033
            source: "Media/PngItem_2022960.png"
            on_release:
                app.root.current = "Main"
                root.manager.transition.direction = 'right'
        Image:
            source: "Media/corner-icon-8-1.png"
            size_hint:0.26,0.15
            pos_hint:{"top":0.85,"x":0.056}
            background_color:(1,1,1,0)
        Image:
            source: "Media/corner-icon-8-2.png"
            size_hint:0.26,0.15
            pos_hint:{"top":0.85,"x":0.69}
            background_color:(1,1,1,0)
        Image:
            source: "Media/corner-icon-8-3.png"
            size_hint:0.26,0.15
            pos_hint:{"top":0.37,"x":0.056}
            background_color:(1,1,1,0)
        Image:
            source: "Media/corner-icon-8-4.png"
            size_hint:0.26,0.15
            pos_hint:{"top":0.37,"x":0.69}
            background_color:(1,1,1,0)
        Label:
            color: 1,0,1,1
            canvas.before:
                Color:
                    rgba: 0.79, 0.79, 0.79, 0.5
                Rectangle:
                    size:0.63*root.width,0.48*root.height
                    pos:0.189*root.width,0.295*root.height
        Label:
            text:"Align the QR Code in the above \n rectangle to scan."
            size_hint:0.733,0.072
            pos_hint:{"top":0.21,"x":0.13}
            color: 0,0,0,1
            halign: 'center'
            valign: 'middle'
            font_size:20

<symptoms>:
    sym1: Fever
    sym2: Cough
    sym3: Sore_throat
    sym4: Soreness
    sym5: Shortness_of_breath
    sym6: Loss_of_smell_or_taste
    submit: Submit

    GridLayout:
        cols:2

        CheckBox:
            id: Fever
            color:.294, .761, .623
            on_active: root.checkbox_click(self, self.active)
            size_hint_x: .20
        Label:
            text: "Fever "

        CheckBox:
            id: Cough
            on_active: root.checkbox_click(self, self.active)
            size_hint_x: .20
        Label:
            text: "Cough "

        CheckBox:
            id: Sore_throat
            on_active: root.checkbox_click(self, self.active)
            size_hint_x: .20
        Label:
            text: "Sore throat "

        CheckBox:
            id: Soreness
            color:.294, .761, .623
            on_active: root.checkbox_click(self, self.active)
            size_hint_x: .20
        Label:
            text: "Soreness "

        CheckBox:
            id: Shortness_of_breath
            on_active: root.checkbox_click(self, self.active)
            size_hint_x: .20
        Label:
            text: "Shortness of breath "

        CheckBox:
            id: Loss_of_smell_or_taste
            on_active: root.checkbox_click(self, self.active)
            size_hint_x: .20
        Label:
            text: "Loss of smell or taste "




<SymptomsScreen>:
    name: "Symptoms"
    go_back: go_back
    sym1: Fever
    sym2: Cough
    sym3: Sore_throat
    sym4: Soreness
    sym5: Shortness_of_breath
    sym6: Loss_of_smell_or_taste
    submit: Submit
    
    FloatLayout:
        # Back button
        ImageButton:
            id:go_back
            pos_hint:{"top":0.97,"x":0.0613}
            size_hint: 0.035,0.033
            source: "Media/PngItem_2022960.png"
            on_release:
                app.root.current = "Profile"
                root.manager.transition.direction = 'right'
        Label:
            text: "Have you had any of these Symptoms \n in the last 24hrs?"
            font_size: 17
            size_hint: 0.93,0.060
            pos_hint:{"top":0.88,"x":0.033}
            halign: 'center'
            valign: 'middle'
            color: (0,0,0,1)

        GridLayout:
            cols:2
            size: root.width * 0.8,root.height * 0.8
            row_default_height: 70
            row_force_default: True
            pos_hint:{"top":0.80,"x":0}


            CheckBox:
                id: Fever
                color:0,0,0,1
                #pos_hint:{"y":0.79,"x":0.2}
            Label:
                text: "Fever "
                color:0,0,0,1
                
            CheckBox:
                id: Cough
                color:0,0,0,1
                #pos_hint:{"y":0.64,"x":0.2}
            Label:
                text: "Cough "
                color:0,0,0,1
                
            CheckBox:
                id: Sore_throat
                color:0,0,0,1
                #pos_hint:{"top":0.49,"x":0.2}
            Label:
                text: "Sore throat "
                color:0,0,0,1
                
            CheckBox:
                id: Soreness
                color:0,0,0,1
                #pos_hint:{"top":0.34,"x":0.2}
            Label:
                text: "Soreness "
                color:0,0,0,1
                
            CheckBox:
                id: Shortness_of_breath
                color:0,0,0,1
                #pos_hint:{"top":0.19,"x":0.2}
            Label:
                text: "Shortness of breath "
                color:0,0,0,1

            CheckBox:
                id: Loss_of_smell_or_taste
                color:0,0,0,1
                #pos_hint:{"top":0.04,"x":0.2}
            Label:
                text: "Loss of smell or taste "
                color:0,0,0,1
        Button:
            id: Submit
            text:"Submit"
            size_hint:0.27,0.0435
            pos_hint:{"top":0.133,"x":0.367}
            on_release:
                root.insert_data_into_db()
                app.root.current = "symptomsHistory"
                root.manager.transition.direction = 'right'


<SymptomsHistoryScreen>:
    name:"symptomsHistory"
    ob1: ob1
    ob2: ob2
    ob3: ob3

    FloatLayout:
    # Back button

        ImageButton:
            id:go_back
            pos_hint:{"top":0.97,"x":0.0613}
            size_hint: 0.035,0.033
            source: "Media/PngItem_2022960.png"
            on_release:
                app.root.current = "Profile"
                root.manager.transition.direction = 'right'
        Label:
            id: ob1
            text:"Recently Reported Symptoms"
            size_hint:0.88,0.045
            pos_hint:{"top":0.89,"x":0.06}
            font_size: 25
            color: (0,0,0,1)
        Label:
            id: ob2
            font_size: 15
            size_hint:0.69,0.11
            pos_hint:{"top":0.77,"x":0.16}
            text:"Your syptoms are x, t, z"
            background_normal:''
            background_color:(1,1,1,1)
        Label:
            font_size: 15
            size_hint:0.69,0.11
            pos_hint:{"top":0.573,"x":0.16}
            text:"Your syptoms are x, t, z"
            background_normal:'blue'
            background_color:(1,1,1,1)
        Label:
            id: ob3
            font_size: 15
            size_hint:0.69,0.11
            pos_hint:{"top":0.384,"x":0.16}
            text:"Your syptoms are x, t, z"
            background_normal:''
            background_color:(1,1,1,1)
        Button:
            text:"See more ..."
            size_hint:0.35,0.0435
            pos_hint:{"top":0.21,"x":0.33}
            background_color: (0,0,0,1)
